aspect Program {

  syn Program Program.merge(Program program);

  eq Program.merge(Program program) {
    final List declarations = new List<>()
      .addAll(getDeclarationList())
      .addAll(program.getDeclarationList());

    return new Program(declarations);
  }
  
  public void Program.inject(Program program) {
    for (Declaration declaration : getDeclarationList()) {
      program.addDeclaration(declaration.fullCopy());
    }

    program.flushCache();
  }

}
