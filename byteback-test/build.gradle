subprojects {
		def core = project(':byteback-core')
		def system = tasks.register('system', Exec) {
				def target = project.findProperty("TARGET")
				if (target == null) {
						target = project.sourceSets.main.java.srcDirs[0]
				}
				def verify = project.findProperty("VERIFY") != null
				environment 'BYTEBACK_ROOT', core.installDist.destinationDir
				environment 'TEST_JAR', project.shadowJar.archivePath
				commandLine 'lit', '-a', target

				dependsOn core.installDist
				dependsOn project.shadowJar
		}
		def benchmark = tasks.register('benchmark', Exec) {
				environment 'BYTEBACK_ROOT', core.installDist.destinationDir
				def script = "../benchmark.py"
				def jar = project.shadowJar.archivePath
				def source = project.sourceSets.main.java.dirs[0]
				def benchmark = "./benchmark"
				def output = "$benchmark/results.csv"
				def tmp = "$benchmark/tmp"

				project.mkdir(benchmark)
				project.mkdir(tmp)

				commandLine 'python', script, '--jar', jar,
						'--source', source, '--output', output, '--temp', tmp

				dependsOn core.installDist
				dependsOn project.shadowJar
		}
}
